<?php
if ($this->context) {
    $categories = $this->context['categories'];
    $items      = $this->context['items'];
    $donors     = $this->context['donors'];

    $showItems = [
        'all'       => 'All Items',
        'forSale'   => 'For Sale',
        'live'      => 'Live',
        'extended'  => 'Extended',
        'noBids'    => 'No Bids',
        'favorites' => 'Favorites'
    ];
    $priceRanges = [
        '_all' => 'All',
        '_0'   => '0 - 100',
        '_1'   => '101 - 250',
        '_2'   => '251 - 500',
        '_5'   => '501+'
    ];

} else {
    echo "No Categories / Items Found";
    return;
}

?>

<div class="auctionItemListWidget">

    <!-- Filtering Side Bar -->
    <div class="sideBar widgetContainer filterBar">
        <h3><?php echo __('Auction Items'); ?></h3>

        <label class="categoryLabel"><?php echo __('Show Items'); ?> :</label>
        <ul class="fancyRadio">
            <?php forEach($showItems as $k => $v) {
                ?>
                <li>
                    <input id="<?php echo $k; ?>" type="radio" name="category" value="<?php echo $k; ?>">
                    <label for="<?php echo $k; ?>"><?php echo __($v); ?></label>
                </li>
            <?php
            }
            ?>
        </ul>

        <label class="categoryLabel"><?php echo __('Categories'); ?>:</label>
        <ul class="categorySort fancyRadio">
            <?php

            forEach ($categories as $category) {
                ?>
                <li>
                    <input id="<?php echo sanitize_html_class($category); ?>" type="radio" name="category" value="<?php echo sanitize_html_class($category); ?>">
                    <label for="<?php echo sanitize_html_class($category); ?>"><?php echo __(ucfirst($category)); ?></label>
                </li>
            <?php
            }

            ?>
        </ul>

        <label class="categoryLabel"><?php echo __('Price Ranges'); ?>:</label>
        <ul class="priceSort fancyRadio">
            <?php
            forEach($priceRanges as $k => $v ) {
                ?>
                <li>
                    <input id="<?php echo $k; ?>" type="radio" name="category" value="<?php echo $k; ?>">
                    <label for="<?php echo $k; ?>"><?php echo __($v); ?></label>
                </li>

                <li><input type="radio" name="priceRange" value=""></li>
            <?php
            }
            ?>
        </ul>
    </div>

    <!-- Item List -->
    <div class="itemList">
        <ul id="container" class="items js-isotope">
            <?php forEach ($items as $item) {

                $currentPrice = $item->currentPrice;

                // By default no filtering is done
                $priceClass = '_all';

                if($currentPrice >= 0 && $currentPrice <= 100 ) {
                    $priceClass = '_0';
                }
                else if($currentPrice >= 101 && $currentPrice < 250) {
                    $priceClass = '_1';
                }
                else if($currentPrice >= 251 && $currentPrice < 500) {
                    $priceClass = '_2';
                }
                else if($currentPrice >= 501) {
                    $priceClass = '_5';
                }

                ?>

                <li class="item item-tile
                <?php echo sanitize_html_class(implode($item->terms)) . ' ' . $priceClass; ?>
                all _all">
                    <a href="/auction-item/?item=<?php echo $item->_id; ?>">
                        <div class="item-content-inner">
                            <div class="image" style="background-image: url(<?php echo $item->images[0]; ?>);">
                                <div class="block currentPrice">
                                    <span><?php echo __('Current bid'); ?></span><span class="price"><?php echo '$' . $currentPrice; ?></span></div>
                                <div class="block itemCode"><?php echo __('Item Code') . ' : ' . $item->itemCode; ?></div>
                            </div>
                            <div class="details">
                                <h2><?php echo $item->name; ?></h2>
                                <div class="bidIncrement"><?php echo __('Bid Increment') . ': $' . $item->bidIncrement; ?></div>
                                <div class="category">Category: Sports</div>
                            </div>
                        </div>
                    </a>
                </li>

            <?php } ?>
        </ul>
    </div>
</div>

