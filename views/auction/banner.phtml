<?php
if ($this->context) {
    $auction  = $this->context['auction'];

    $coords = null;

    if(isset($this->context['coords']) || is_array($this->context['coords'])) {
        $coords   = $this->context['coords'];
    }

    var_dump($auction); exit;
    
    $org      = $auction->meta->organization;

} else {
    echo "No Auction Set";
    return;
}

if(!$coords) {
    ?>
    <h1 class="page-title entry-title"><?php echo $auction->name; ?></h1>
    <?php
        return;
} ?>


<header id="title-area" class="clearfix headerCover"><div class="inner" style="opacity: 1;"><h1 class="page-title entry-title"><?php echo $auction->name; ?></h1></div></header>

<div class="bannerContainer">
    <div class="statusContainer">
        <div class="name"><a href="/organization?organization=<?php echo $org->id; ?>"><?php echo $org->name; ?></a></div>
        <div class="status closed"><? __('Auction is') . ' ' . $auction->status . ' ' . __('for Bidding'); ?></div>
    </div>

    <?php if ($auction->status != "closed") {
        ?>
        <?php if(isset($auction->closingTime)) { ?>
            <div class="timeRemaining"><?php echo __('Auction closes in ') . $auction->closingTime; ?></div>
        <?php } ?>
    <?php
    } ?>

    <div class="map-frame">
        <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false">
        </script>
        <div style="width:100%;">
            <div style="overflow:hidden; height:500px; width:100%;">
                <div id="gmap_canvas" style="height:500px; width:100%;">
                </div>
                <a href="http://www.embed-google-map.com" class="map-data">http://www.embed-google-map.com</a>
                <iframe src="http://www.embed-google-map.com/google-map-data.php"></iframe>
                <style>
                    .gmap {
                        position: relative;
                        line-height: 1.12;
                        overflow: hidden;
                        color: #000;
                        white-space: nowrap;
                        display: block;
                        margin-bottom: 2px;
                        font-weight: 500;
                    }
                </style>
            </div>
            <script type="text/javascript">function init_map() {
                    var myOptions = {
                        zoom:             17,
                        center:           new google.maps.LatLng(<?php echo $coords->lon; ?>, <?php echo $coords->lat; ?>),
                        mapTypeId:        google.maps.MapTypeId.ROADMAP,
                        disableDefaultUI: true
                    };
                    map = new google.maps.Map(document.getElementById("gmap_canvas"), myOptions);
                    marker = new google.maps.Marker({map: map, position: new google.maps.LatLng(<?php echo $coords->lon; ?>, <?php echo $coords->lat; ?>)});
                    infowindow = new google.maps.InfoWindow({content: "<span class='gmap'><b><?php echo $auction->name; ?></b></span><span class='gmap'><?php echo $auction->vanityAddress; ?></span><span class='gmap'></span>" });
                    google.maps.event.addListener(marker, "click", function () {
                        infowindow.open(map, marker);
                    });
                    infowindow.open(map, marker);
                }
                google.maps.event.addDomListener(window, "load", init_map);
            </script>
        </div>
    </div>
</div>